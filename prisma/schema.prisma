generator client {
  provider = "prisma-client-js"
}

datasource db {
provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL") // マイグレーション時はこちらを使用
}

model User {
  id        String     @id @default(uuid())
  name      String
  email     String     @unique
  image     String?
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt

  Profile   Profile?
  Diary     Diary[]
  UserTag   UserTag[]
}

model Profile {
  id         String   @id @map("user_id")
  typeResult String?  @db.Text
  bio        String?  @db.Text
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  User       User     @relation(fields: [id], references: [id], onDelete: Cascade)
}

model Tag {
  id      Int       @id @default(autoincrement())
  name    String    @unique
  UserTag UserTag[]
}

model UserTag {
  id     Int   @id @default(autoincrement())
  userId String
  tagId  Int

  User   User @relation(fields: [userId], references: [id], onDelete: Cascade)
  Tag    Tag  @relation(fields: [tagId], references: [id], onDelete: Cascade)
}

model Diary {
  id        String   @id @default(uuid())
  userId    String
  title     String   @db.Text
  content   String   @db.Text
  summary   String?  @db.Text
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  User      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}
